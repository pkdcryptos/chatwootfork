{"version":3,"sources":["webpack:///./app/javascript/dashboard/helper/validations.js","webpack:///./app/javascript/dashboard/components/widgets/AutomationActionInput.vue?ad77","webpack:///./app/javascript/dashboard/components/widgets/AutomationActionTeamMessageInput.vue?ae91","webpack:///app/javascript/dashboard/components/widgets/AutomationActionTeamMessageInput.vue","webpack:///./app/javascript/dashboard/components/widgets/AutomationActionTeamMessageInput.vue","webpack:///./app/javascript/dashboard/components/widgets/AutomationActionTeamMessageInput.vue?daed","webpack:///app/javascript/dashboard/components/widgets/AutomationFileInput.vue","webpack:///./app/javascript/dashboard/components/widgets/AutomationFileInput.vue?db5d","webpack:///app/javascript/dashboard/components/widgets/AutomationActionInput.vue","webpack:///./app/javascript/dashboard/components/widgets/AutomationActionInput.vue?b8ec","webpack:///./app/javascript/dashboard/components/widgets/AutomationFileInput.vue","webpack:///./app/javascript/dashboard/components/widgets/AutomationFileInput.vue?6664","webpack:///./app/javascript/dashboard/components/widgets/AutomationActionInput.vue","webpack:///./app/javascript/dashboard/helper/automationHelper.js","webpack:///./app/javascript/dashboard/routes/dashboard/settings/automation/operators.js","webpack:///./app/javascript/dashboard/helper/actionQueryGenerator.js","webpack:///./app/javascript/dashboard/components/widgets/AutomationActionTeamMessageInput.vue?17a2","webpack:///./app/javascript/dashboard/components/widgets/AutomationFileInput.vue?f6e8","webpack:///./app/javascript/dashboard/components/widgets/AutomationActionInput.vue?a35a"],"names":["validateSingleFilter","filter","attribute_key","filter_operator","values","Array","isArray","length","parseInt","validateConversationOrContactFilters","filters","errors","forEach","index","error","validateActions","actions","reduce","action","includes","action_name","action_params","validateSingleAction","validateAutomation","automation","conditions","basicErrors","field","charAt","toUpperCase","slice","validateBasicFields","conditionErrors","condition","actionErrors","_vm","this","_c","_self","staticClass","attrs","$t","teams","on","updateValue","model","value","callback","$$v","selectedTeams","expression","_v","directives","name","rawName","domProps","$event","target","composing","message","class","uploadState","onChangeFile","_e","_s","label","actionInputStyles","showActionInput","$$selectedVal","prototype","call","options","o","selected","map","_value","multiple","resetAction","_l","attribute","key","inputType","dropdownValues","initialFileName","isMacro","removeAction","castMessageVmodel","errorMessage","MESSAGE_CONDITION_VALUES","id","PRIORITY_CONDITION_VALUES","getCustomAttributeInputType","date","text","list","checkbox","isACustomAttribute","customAttributes","find","attr","getOperatorTypes","OPERATOR_TYPES_1","OPERATOR_TYPES_3","number","link","OPERATOR_TYPES_4","generateCustomAttributeTypes","type","attribute_display_name","attribute_display_type","filterOperators","customAttributeType","generateConditionOptions","i","title","addNoneToList","agents","getActionOptions","labels","slaPolicies","assign_agent","assign_team","send_email_to_team","add_label","remove_label","change_priority","add_sla","getConditionOptions","booleanFilterOptions","campaigns","contacts","countries","inboxes","languages","statusFilterOptions","isCustomAttributeCheckbox","isCustomAttributeList","attribute_values","item","getCustomAttributeListDropdownValues","status","assignee_id","contact","inbox_id","team_id","browser_language","conversation_language","country_code","message_type","priority","getFileName","files","blobId","file","blob_id","filename","toString","getDefaultConditions","eventName","query_operator","custom_attribute_type","getDefaultActions","filterCustomAttributes","getStandardAttributeInputType","automationTypes","event","generateAutomationPayload","payload","JSON","parse","stringify","filterQueryGenerator","actionQueryGenerator","isCustomAttribute","generateCustomAttributes","conversationAttributes","contactAttributes","conversationlabel","contactlabel","push","disabled","OPERATOR_TYPES_2","OPERATOR_TYPES_6","generatePayload","data","params","every","elem","val","generatePayloadForObject"],"mappings":"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","file":"js/16-327fee6c23627c58053b.chunk.js","sourcesContent":["export const ATTRIBUTE_KEY_REQUIRED = 'ATTRIBUTE_KEY_REQUIRED';\nexport const FILTER_OPERATOR_REQUIRED = 'FILTER_OPERATOR_REQUIRED';\nexport const VALUE_REQUIRED = 'VALUE_REQUIRED';\nexport const VALUE_MUST_BE_BETWEEN_1_AND_998 =\n  'VALUE_MUST_BE_BETWEEN_1_AND_998';\nexport const ACTION_PARAMETERS_REQUIRED = 'ACTION_PARAMETERS_REQUIRED';\nexport const ATLEAST_ONE_CONDITION_REQUIRED = 'ATLEAST_ONE_CONDITION_REQUIRED';\nexport const ATLEAST_ONE_ACTION_REQUIRED = 'ATLEAST_ONE_ACTION_REQUIRED';\n// ------------------------------------------------------------------\n// ------------------------ Filter Validation -----------------------\n// ------------------------------------------------------------------\n\n/**\n * Validates a single filter for conversations or contacts.\n *\n * @param {Object} filter - The filter object to validate.\n * @param {string} filter.attribute_key - The key of the attribute to filter on.\n * @param {string} filter.filter_operator - The operator to use for filtering.\n * @param {string|number|Array} [filter.values] - The value(s) to filter by (required for most operators).\n *\n * @returns {string|null} An error message if validation fails, or null if validation passes.\n */\nconst validateSingleFilter = filter => {\n  if (!filter.attribute_key) {\n    return ATTRIBUTE_KEY_REQUIRED;\n  }\n\n  if (!filter.filter_operator) {\n    return FILTER_OPERATOR_REQUIRED;\n  }\n\n  if (\n    filter.filter_operator !== 'is_present' &&\n    filter.filter_operator !== 'is_not_present' &&\n    (!filter.values ||\n      (Array.isArray(filter.values) && filter.values.length === 0))\n  ) {\n    return VALUE_REQUIRED;\n  }\n\n  if (\n    filter.filter_operator === 'days_before' &&\n    (parseInt(filter.values, 10) <= 0 || parseInt(filter.values, 10) >= 999)\n  ) {\n    return VALUE_MUST_BE_BETWEEN_1_AND_998;\n  }\n\n  return null;\n};\n\n/**\n * Validates filters for conversations or contacts.\n *\n * @param {Array} filters - An array of filter objects to validate.\n * @param {string} filters[].attribute_key - The key of the attribute to filter on.\n * @param {string} filters[].filter_operator - The operator to use for filtering.\n * @param {string|number} [filters[].values] - The value(s) to filter by (required for most operators).\n *\n * @returns {Object} An object containing any validation errors, keyed by filter index.\n */\nexport const validateConversationOrContactFilters = filters => {\n  const errors = {};\n\n  filters.forEach((filter, index) => {\n    const error = validateSingleFilter(filter);\n    if (error) {\n      errors[`filter_${index}`] = error;\n    }\n  });\n\n  return errors;\n};\n\n// ------------------------------------------------------------------\n// ---------------------- Automation Validation ---------------------\n// ------------------------------------------------------------------\n\n/**\n * Validates the basic fields of an automation object.\n *\n * @param {Object} automation - The automation object to validate.\n * @returns {Object} An object containing any validation errors.\n */\nconst validateBasicFields = automation => {\n  const errors = {};\n  const requiredFields = ['name', 'description', 'event_name'];\n\n  requiredFields.forEach(field => {\n    if (!automation[field]) {\n      errors[field] = `${\n        field.charAt(0).toUpperCase() + field.slice(1)\n      } is required`;\n    }\n  });\n\n  return errors;\n};\n\n/**\n * Validates the conditions of an automation object.\n *\n * @param {Array} conditions - The conditions to validate.\n * @returns {Object} An object containing any validation errors.\n */\nexport const validateConditions = conditions => {\n  const errors = {};\n\n  if (!conditions || conditions.length === 0) {\n    errors.conditions = ATLEAST_ONE_CONDITION_REQUIRED;\n    return errors;\n  }\n\n  conditions.forEach((condition, index) => {\n    const error = validateSingleFilter(condition);\n    if (error) {\n      errors[`condition_${index}`] = error;\n    }\n  });\n\n  return errors;\n};\n\n/**\n * Validates a single action of an automation object.\n *\n * @param {Object} action - The action to validate.\n * @returns {string|null} An error message if validation fails, or null if validation passes.\n */\nconst validateSingleAction = action => {\n  const noParamActions = [\n    'mute_conversation',\n    'snooze_conversation',\n    'resolve_conversation',\n    'remove_assigned_team',\n  ];\n\n  if (\n    !noParamActions.includes(action.action_name) &&\n    (!action.action_params || action.action_params.length === 0)\n  ) {\n    return ACTION_PARAMETERS_REQUIRED;\n  }\n\n  return null;\n};\n\n/**\n * Validates the actions of an automation object.\n *\n * @param {Array} actions - The actions to validate.\n * @returns {Object} An object containing any validation errors.\n */\nexport const validateActions = actions => {\n  if (!actions || actions.length === 0) {\n    return { actions: ATLEAST_ONE_ACTION_REQUIRED };\n  }\n\n  return actions.reduce((errors, action, index) => {\n    const error = validateSingleAction(action);\n    if (error) {\n      errors[`action_${index}`] = error;\n    }\n    return errors;\n  }, {});\n};\n\n/**\n * Validates an automation object.\n *\n * @param {Object} automation - The automation object to validate.\n * @param {string} automation.name - The name of the automation.\n * @param {string} automation.description - The description of the automation.\n * @param {string} automation.event_name - The name of the event that triggers the automation.\n * @param {Array} automation.conditions - An array of condition objects for the automation.\n * @param {string} automation.conditions[].filter_operator - The operator for the condition.\n * @param {string|number} [automation.conditions[].values] - The value(s) for the condition.\n * @param {Array} automation.actions - An array of action objects for the automation.\n * @param {string} automation.actions[].action_name - The name of the action.\n * @param {Array} [automation.actions[].action_params] - The parameters for the action.\n *\n * @returns {Object} An object containing any validation errors.\n */\nexport const validateAutomation = automation => {\n  const basicErrors = validateBasicFields(automation);\n  const conditionErrors = validateConditions(automation.conditions);\n  const actionErrors = validateActions(automation.actions);\n\n  return {\n    ...basicErrors,\n    ...conditionErrors,\n    ...actionErrors,\n  };\n};\n","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"filter\",class:_vm.actionInputStyles},[_c('div',{staticClass:\"filter-inputs\"},[_c('select',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.action_name),expression:\"action_name\"}],staticClass:\"action__question\",class:{ 'full-width': !_vm.showActionInput },on:{\"change\":[function($event){var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = \"_value\" in o ? o._value : o.value;return val}); _vm.action_name=$event.target.multiple ? $$selectedVal : $$selectedVal[0]},function($event){return _vm.resetAction()}]}},_vm._l((_vm.actionTypes),function(attribute){return _c('option',{key:attribute.key,domProps:{\"value\":attribute.key}},[_vm._v(\"\\n        \"+_vm._s(attribute.label)+\"\\n      \")])}),0),_vm._v(\" \"),(_vm.showActionInput)?_c('div',{staticClass:\"filter__answer--wrap\"},[(_vm.inputType)?_c('div',{staticClass:\"w-full\"},[(_vm.inputType === 'search_select')?_c('div',{staticClass:\"multiselect-wrap--small\"},[_c('multiselect',{attrs:{\"track-by\":\"id\",\"label\":\"name\",\"placeholder\":_vm.$t('FORMS.MULTISELECT.SELECT'),\"selected-label\":\"\",\"select-label\":_vm.$t('FORMS.MULTISELECT.ENTER_TO_SELECT'),\"deselect-label\":\"\",\"max-height\":160,\"options\":_vm.dropdownValues,\"allow-empty\":false,\"option-height\":104},model:{value:(_vm.action_params),callback:function ($$v) {_vm.action_params=$$v},expression:\"action_params\"}})],1):(_vm.inputType === 'multi_select')?_c('div',{staticClass:\"multiselect-wrap--small\"},[_c('multiselect',{attrs:{\"track-by\":\"id\",\"label\":\"name\",\"placeholder\":_vm.$t('FORMS.MULTISELECT.SELECT'),\"multiple\":true,\"selected-label\":\"\",\"select-label\":_vm.$t('FORMS.MULTISELECT.ENTER_TO_SELECT'),\"deselect-label\":\"\",\"max-height\":160,\"options\":_vm.dropdownValues,\"allow-empty\":false,\"option-height\":104},model:{value:(_vm.action_params),callback:function ($$v) {_vm.action_params=$$v},expression:\"action_params\"}})],1):(_vm.inputType === 'email')?_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.action_params),expression:\"action_params\"}],staticClass:\"answer--text-input\",attrs:{\"type\":\"email\",\"placeholder\":\"Enter email\"},domProps:{\"value\":(_vm.action_params)},on:{\"input\":function($event){if($event.target.composing)return;_vm.action_params=$event.target.value}}}):(_vm.inputType === 'url')?_c('input',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.action_params),expression:\"action_params\"}],staticClass:\"answer--text-input\",attrs:{\"type\":\"url\",\"placeholder\":\"Enter url\"},domProps:{\"value\":(_vm.action_params)},on:{\"input\":function($event){if($event.target.composing)return;_vm.action_params=$event.target.value}}}):_vm._e(),_vm._v(\" \"),(_vm.inputType === 'attachment')?_c('automation-action-file-input',{attrs:{\"initial-file-name\":_vm.initialFileName},model:{value:(_vm.action_params),callback:function ($$v) {_vm.action_params=$$v},expression:\"action_params\"}}):_vm._e()],1):_vm._e()]):_vm._e(),_vm._v(\" \"),(!_vm.isMacro)?_c('woot-button',{attrs:{\"icon\":\"dismiss\",\"variant\":\"clear\",\"color-scheme\":\"secondary\"},on:{\"click\":_vm.removeAction}}):_vm._e()],1),_vm._v(\" \"),(_vm.inputType === 'team_message')?_c('automation-action-team-message-input',{attrs:{\"teams\":_vm.dropdownValues},model:{value:(_vm.action_params),callback:function ($$v) {_vm.action_params=$$v},expression:\"action_params\"}}):_vm._e(),_vm._v(\" \"),(_vm.inputType === 'textarea')?_c('woot-message-editor',{staticClass:\"action-message\",attrs:{\"rows\":\"4\",\"enable-variables\":true,\"placeholder\":_vm.$t('AUTOMATION.ACTION.TEAM_MESSAGE_INPUT_PLACEHOLDER')},model:{value:(_vm.castMessageVmodel),callback:function ($$v) {_vm.castMessageVmodel=$$v},expression:\"castMessageVmodel\"}}):_vm._e(),_vm._v(\" \"),(_vm.errorMessage)?_c('p',{staticClass:\"filter-error\"},[_vm._v(\"\\n    \"+_vm._s(_vm.errorMessage)+\"\\n  \")]):_vm._e()],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import mod from \"-!../../../../../node_modules/babel-loader/lib/index.js??ref--7-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AutomationActionTeamMessageInput.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/babel-loader/lib/index.js??ref--7-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AutomationActionTeamMessageInput.vue?vue&type=script&lang=js&\"","<template>\n  <div>\n    <div class=\"multiselect-wrap--small\">\n      <multiselect\n        v-model=\"selectedTeams\"\n        track-by=\"id\"\n        label=\"name\"\n        :placeholder=\"$t('AUTOMATION.ACTION.TEAM_DROPDOWN_PLACEHOLDER')\"\n        :multiple=\"true\"\n        selected-label\n        :select-label=\"$t('FORMS.MULTISELECT.ENTER_TO_SELECT')\"\n        deselect-label=\"\"\n        :max-height=\"160\"\n        :options=\"teams\"\n        :allow-empty=\"false\"\n        @input=\"updateValue\"\n      />\n      <textarea\n        v-model=\"message\"\n        rows=\"4\"\n        :placeholder=\"$t('AUTOMATION.ACTION.TEAM_MESSAGE_INPUT_PLACEHOLDER')\"\n        @input=\"updateValue\"\n      />\n    </div>\n  </div>\n</template>\n\n<script>\nexport default {\n  // The value types are dynamic, hence prop validation removed to work with our action schema\n  // eslint-disable-next-line vue/require-prop-types\n  props: ['teams', 'value'],\n  data() {\n    return {\n      selectedTeams: [],\n      message: '',\n    };\n  },\n  mounted() {\n    const { team_ids: teamIds } = this.value;\n    this.selectedTeams = teamIds;\n    this.message = this.value.message;\n  },\n  methods: {\n    updateValue() {\n      this.$emit('input', {\n        team_ids: this.selectedTeams.map(team => team.id),\n        message: this.message,\n      });\n    },\n  },\n};\n</script>\n\n<style scoped>\n.multiselect {\n  margin: var(--space-smaller) var(--space-zero);\n}\ntextarea {\n  margin-bottom: var(--space-zero);\n}\n</style>\n","import { render, staticRenderFns } from \"./AutomationActionTeamMessageInput.vue?vue&type=template&id=3a0353d8&scoped=true&\"\nimport script from \"./AutomationActionTeamMessageInput.vue?vue&type=script&lang=js&\"\nexport * from \"./AutomationActionTeamMessageInput.vue?vue&type=script&lang=js&\"\nimport style0 from \"./AutomationActionTeamMessageInput.vue?vue&type=style&index=0&id=3a0353d8&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"3a0353d8\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',[_c('div',{staticClass:\"multiselect-wrap--small\"},[_c('multiselect',{attrs:{\"track-by\":\"id\",\"label\":\"name\",\"placeholder\":_vm.$t('AUTOMATION.ACTION.TEAM_DROPDOWN_PLACEHOLDER'),\"multiple\":true,\"selected-label\":\"\",\"select-label\":_vm.$t('FORMS.MULTISELECT.ENTER_TO_SELECT'),\"deselect-label\":\"\",\"max-height\":160,\"options\":_vm.teams,\"allow-empty\":false},on:{\"input\":_vm.updateValue},model:{value:(_vm.selectedTeams),callback:function ($$v) {_vm.selectedTeams=$$v},expression:\"selectedTeams\"}}),_vm._v(\" \"),_c('textarea',{directives:[{name:\"model\",rawName:\"v-model\",value:(_vm.message),expression:\"message\"}],attrs:{\"rows\":\"4\",\"placeholder\":_vm.$t('AUTOMATION.ACTION.TEAM_MESSAGE_INPUT_PLACEHOLDER')},domProps:{\"value\":(_vm.message)},on:{\"input\":[function($event){if($event.target.composing)return;_vm.message=$event.target.value},_vm.updateValue]}})],1)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <label class=\"input-wrapper\" :class=\"uploadState\">\n    <input\n      v-if=\"uploadState !== 'processing'\"\n      type=\"file\"\n      name=\"attachment\"\n      :class=\"uploadState === 'processing' ? 'disabled' : ''\"\n      @change=\"onChangeFile\"\n    />\n    <spinner v-if=\"uploadState === 'processing'\" />\n    <fluent-icon v-if=\"uploadState === 'idle'\" icon=\"file-upload\" />\n    <fluent-icon\n      v-if=\"uploadState === 'uploaded'\"\n      icon=\"checkmark-circle\"\n      type=\"outline\"\n      class=\"success-icon\"\n    />\n    <fluent-icon\n      v-if=\"uploadState === 'failed'\"\n      icon=\"dismiss-circle\"\n      type=\"outline\"\n      class=\"error-icon\"\n    />\n    <p class=\"file-button\">{{ label }}</p>\n  </label>\n</template>\n\n<script>\nimport { useAlert } from 'dashboard/composables';\nimport Spinner from 'shared/components/Spinner.vue';\nexport default {\n  components: {\n    Spinner,\n  },\n  props: {\n    value: {\n      type: Array,\n      default: () => [],\n    },\n    initialFileName: {\n      type: String,\n      default: '',\n    },\n  },\n  data() {\n    return {\n      uploadState: 'idle',\n      label: this.$t('AUTOMATION.ATTACHMENT.LABEL_IDLE'),\n    };\n  },\n  mounted() {\n    if (this.initialFileName) {\n      this.label = this.initialFileName;\n      this.uploadState = 'uploaded';\n    }\n  },\n  methods: {\n    async onChangeFile(event) {\n      this.uploadState = 'processing';\n      this.label = this.$t('AUTOMATION.ATTACHMENT.LABEL_UPLOADING');\n      try {\n        const file = event.target.files[0];\n        const id = await this.$store.dispatch(\n          'automations/uploadAttachment',\n          file\n        );\n        this.$emit('input', [id]);\n        this.uploadState = 'uploaded';\n        this.label = this.$t('AUTOMATION.ATTACHMENT.LABEL_UPLOADED');\n      } catch (error) {\n        this.uploadState = 'failed';\n        this.label = this.$t('AUTOMATION.ATTACHMENT.LABEL_UPLOAD_FAILED');\n        useAlert(this.$t('AUTOMATION.ATTACHMENT.UPLOAD_ERROR'));\n      }\n    },\n  },\n};\n</script>\n\n<style scoped>\ninput[type='file'] {\n  @apply hidden;\n}\n.input-wrapper {\n  @apply flex h-9 bg-white dark:bg-slate-900 py-1 px-2 items-center text-xs cursor-pointer rounded-sm border border-dashed border-woot-100 dark:border-woot-500;\n}\n.success-icon {\n  @apply text-green-500 dark:text-green-600 mr-2;\n}\n.error-icon {\n  @apply text-red-500 dark:text-red-600 mr-2;\n}\n\n.processing {\n  @apply cursor-not-allowed opacity-90;\n}\n.file-button {\n  @apply whitespace-nowrap overflow-hidden text-ellipsis w-full mb-0;\n}\n</style>\n","import mod from \"-!../../../../../node_modules/babel-loader/lib/index.js??ref--7-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AutomationFileInput.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/babel-loader/lib/index.js??ref--7-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AutomationFileInput.vue?vue&type=script&lang=js&\"","<template>\n  <div class=\"filter\" :class=\"actionInputStyles\">\n    <div class=\"filter-inputs\">\n      <select\n        v-model=\"action_name\"\n        class=\"action__question\"\n        :class=\"{ 'full-width': !showActionInput }\"\n        @change=\"resetAction()\"\n      >\n        <option\n          v-for=\"attribute in actionTypes\"\n          :key=\"attribute.key\"\n          :value=\"attribute.key\"\n        >\n          {{ attribute.label }}\n        </option>\n      </select>\n      <div v-if=\"showActionInput\" class=\"filter__answer--wrap\">\n        <div v-if=\"inputType\" class=\"w-full\">\n          <div\n            v-if=\"inputType === 'search_select'\"\n            class=\"multiselect-wrap--small\"\n          >\n            <multiselect\n              v-model=\"action_params\"\n              track-by=\"id\"\n              label=\"name\"\n              :placeholder=\"$t('FORMS.MULTISELECT.SELECT')\"\n              selected-label\n              :select-label=\"$t('FORMS.MULTISELECT.ENTER_TO_SELECT')\"\n              deselect-label=\"\"\n              :max-height=\"160\"\n              :options=\"dropdownValues\"\n              :allow-empty=\"false\"\n              :option-height=\"104\"\n            />\n          </div>\n          <div\n            v-else-if=\"inputType === 'multi_select'\"\n            class=\"multiselect-wrap--small\"\n          >\n            <multiselect\n              v-model=\"action_params\"\n              track-by=\"id\"\n              label=\"name\"\n              :placeholder=\"$t('FORMS.MULTISELECT.SELECT')\"\n              :multiple=\"true\"\n              selected-label\n              :select-label=\"$t('FORMS.MULTISELECT.ENTER_TO_SELECT')\"\n              deselect-label=\"\"\n              :max-height=\"160\"\n              :options=\"dropdownValues\"\n              :allow-empty=\"false\"\n              :option-height=\"104\"\n            />\n          </div>\n          <input\n            v-else-if=\"inputType === 'email'\"\n            v-model=\"action_params\"\n            type=\"email\"\n            class=\"answer--text-input\"\n            placeholder=\"Enter email\"\n          />\n          <input\n            v-else-if=\"inputType === 'url'\"\n            v-model=\"action_params\"\n            type=\"url\"\n            class=\"answer--text-input\"\n            placeholder=\"Enter url\"\n          />\n          <automation-action-file-input\n            v-if=\"inputType === 'attachment'\"\n            v-model=\"action_params\"\n            :initial-file-name=\"initialFileName\"\n          />\n        </div>\n      </div>\n      <woot-button\n        v-if=\"!isMacro\"\n        icon=\"dismiss\"\n        variant=\"clear\"\n        color-scheme=\"secondary\"\n        @click=\"removeAction\"\n      />\n    </div>\n    <automation-action-team-message-input\n      v-if=\"inputType === 'team_message'\"\n      v-model=\"action_params\"\n      :teams=\"dropdownValues\"\n    />\n    <woot-message-editor\n      v-if=\"inputType === 'textarea'\"\n      v-model=\"castMessageVmodel\"\n      rows=\"4\"\n      :enable-variables=\"true\"\n      :placeholder=\"$t('AUTOMATION.ACTION.TEAM_MESSAGE_INPUT_PLACEHOLDER')\"\n      class=\"action-message\"\n    />\n    <p v-if=\"errorMessage\" class=\"filter-error\">\n      {{ errorMessage }}\n    </p>\n  </div>\n</template>\n\n<script>\nimport AutomationActionTeamMessageInput from './AutomationActionTeamMessageInput.vue';\nimport AutomationActionFileInput from './AutomationFileInput.vue';\nimport WootMessageEditor from 'dashboard/components/widgets/WootWriter/Editor.vue';\nexport default {\n  components: {\n    AutomationActionTeamMessageInput,\n    AutomationActionFileInput,\n    WootMessageEditor,\n  },\n  props: {\n    value: {\n      type: Object,\n      default: () => null,\n    },\n    actionTypes: {\n      type: Array,\n      default: () => [],\n    },\n    dropdownValues: {\n      type: Array,\n      default: () => [],\n    },\n    errorMessage: {\n      type: String,\n      default: '',\n    },\n    showActionInput: {\n      type: Boolean,\n      default: true,\n    },\n    initialFileName: {\n      type: String,\n      default: '',\n    },\n    isMacro: {\n      type: Boolean,\n      default: false,\n    },\n  },\n  computed: {\n    action_name: {\n      get() {\n        if (!this.value) return null;\n        return this.value.action_name;\n      },\n      set(value) {\n        const payload = this.value || {};\n        this.$emit('input', { ...payload, action_name: value });\n      },\n    },\n    action_params: {\n      get() {\n        if (!this.value) return null;\n        return this.value.action_params;\n      },\n      set(value) {\n        const payload = this.value || {};\n        this.$emit('input', { ...payload, action_params: value });\n      },\n    },\n    inputType() {\n      return this.actionTypes.find(action => action.key === this.action_name)\n        .inputType;\n    },\n    actionInputStyles() {\n      return {\n        'has-error': this.errorMessage,\n        'is-a-macro': this.isMacro,\n      };\n    },\n    castMessageVmodel: {\n      get() {\n        if (Array.isArray(this.action_params)) {\n          return this.action_params[0];\n        }\n        return this.action_params;\n      },\n      set(value) {\n        this.action_params = value;\n      },\n    },\n  },\n  methods: {\n    removeAction() {\n      this.$emit('removeAction');\n    },\n    resetAction() {\n      this.$emit('resetAction');\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n.filter {\n  @apply bg-slate-50 dark:bg-slate-800 p-2 border border-solid border-slate-75 dark:border-slate-600 rounded-md mb-2;\n\n  &.is-a-macro {\n    @apply mb-0 bg-white dark:bg-slate-700 p-0 border-0 rounded-none;\n  }\n}\n\n.no-margin-bottom {\n  @apply mb-0;\n}\n\n.filter.has-error {\n  @apply bg-red-50 dark:bg-red-800/50 border-red-100 dark:border-red-700/50;\n}\n\n.filter-inputs {\n  @apply flex;\n}\n\n.filter-error {\n  @apply text-red-500 dark:text-red-200 block my-1 mx-0;\n}\n\n.action__question,\n.filter__operator {\n  @apply mb-0 mr-1;\n}\n\n.action__question {\n  @apply max-w-[50%];\n}\n\n.action__question.full-width {\n  @apply max-w-full;\n}\n\n.filter__answer--wrap {\n  @apply max-w-[50%] flex-grow mr-1 flex w-full items-center justify-start;\n\n  input {\n    @apply mb-0;\n  }\n}\n.filter__answer {\n  &.answer--text-input {\n    @apply mb-0;\n  }\n}\n\n.filter__join-operator-wrap {\n  @apply relative z-20 m-0;\n}\n\n.filter__join-operator {\n  @apply flex items-center justify-center relative my-2.5 mx-0;\n\n  .operator__line {\n    @apply absolute w-full border-b border-solid border-slate-75 dark:border-slate-600;\n  }\n\n  .operator__select {\n    margin-bottom: var(--space-zero) !important;\n    @apply relative w-auto;\n  }\n}\n\n.multiselect {\n  @apply mb-0;\n}\n.action-message {\n  @apply mt-2 mx-0 mb-0;\n}\n// Prosemirror does not have a native way of hiding the menu bar, hence\n::v-deep .ProseMirror-menubar {\n  @apply hidden;\n}\n</style>\n","import mod from \"-!../../../../../node_modules/babel-loader/lib/index.js??ref--7-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AutomationActionInput.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../node_modules/babel-loader/lib/index.js??ref--7-0!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AutomationActionInput.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./AutomationFileInput.vue?vue&type=template&id=25150911&scoped=true&\"\nimport script from \"./AutomationFileInput.vue?vue&type=script&lang=js&\"\nexport * from \"./AutomationFileInput.vue?vue&type=script&lang=js&\"\nimport style0 from \"./AutomationFileInput.vue?vue&type=style&index=0&id=25150911&prod&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"25150911\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('label',{staticClass:\"input-wrapper\",class:_vm.uploadState},[(_vm.uploadState !== 'processing')?_c('input',{class:_vm.uploadState === 'processing' ? 'disabled' : '',attrs:{\"type\":\"file\",\"name\":\"attachment\"},on:{\"change\":_vm.onChangeFile}}):_vm._e(),_vm._v(\" \"),(_vm.uploadState === 'processing')?_c('spinner'):_vm._e(),_vm._v(\" \"),(_vm.uploadState === 'idle')?_c('fluent-icon',{attrs:{\"icon\":\"file-upload\"}}):_vm._e(),_vm._v(\" \"),(_vm.uploadState === 'uploaded')?_c('fluent-icon',{staticClass:\"success-icon\",attrs:{\"icon\":\"checkmark-circle\",\"type\":\"outline\"}}):_vm._e(),_vm._v(\" \"),(_vm.uploadState === 'failed')?_c('fluent-icon',{staticClass:\"error-icon\",attrs:{\"icon\":\"dismiss-circle\",\"type\":\"outline\"}}):_vm._e(),_vm._v(\" \"),_c('p',{staticClass:\"file-button\"},[_vm._v(_vm._s(_vm.label))])],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import { render, staticRenderFns } from \"./AutomationActionInput.vue?vue&type=template&id=0c5a16cc&scoped=true&\"\nimport script from \"./AutomationActionInput.vue?vue&type=script&lang=js&\"\nexport * from \"./AutomationActionInput.vue?vue&type=script&lang=js&\"\nimport style0 from \"./AutomationActionInput.vue?vue&type=style&index=0&id=0c5a16cc&prod&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"0c5a16cc\",\n  null\n  \n)\n\nexport default component.exports","import {\n  OPERATOR_TYPES_1,\n  OPERATOR_TYPES_3,\n  OPERATOR_TYPES_4,\n} from 'dashboard/routes/dashboard/settings/automation/operators';\nimport filterQueryGenerator from './filterQueryGenerator';\nimport actionQueryGenerator from './actionQueryGenerator';\nconst MESSAGE_CONDITION_VALUES = [\n  {\n    id: 'incoming',\n    name: 'Incoming Message',\n  },\n  {\n    id: 'outgoing',\n    name: 'Outgoing Message',\n  },\n];\n\nexport const PRIORITY_CONDITION_VALUES = [\n  {\n    id: 'nil',\n    name: 'None',\n  },\n  {\n    id: 'low',\n    name: 'Low',\n  },\n  {\n    id: 'medium',\n    name: 'Medium',\n  },\n  {\n    id: 'high',\n    name: 'High',\n  },\n  {\n    id: 'urgent',\n    name: 'Urgent',\n  },\n];\n\nexport const getCustomAttributeInputType = key => {\n  const customAttributeMap = {\n    date: 'date',\n    text: 'plain_text',\n    list: 'search_select',\n    checkbox: 'search_select',\n  };\n\n  return customAttributeMap[key] || 'plain_text';\n};\n\nexport const isACustomAttribute = (customAttributes, key) => {\n  return customAttributes.find(attr => {\n    return attr.attribute_key === key;\n  });\n};\n\nexport const getCustomAttributeListDropdownValues = (\n  customAttributes,\n  type\n) => {\n  return customAttributes\n    .find(attr => attr.attribute_key === type)\n    .attribute_values.map(item => {\n      return {\n        id: item,\n        name: item,\n      };\n    });\n};\n\nexport const isCustomAttributeCheckbox = (customAttributes, key) => {\n  return customAttributes.find(attr => {\n    return (\n      attr.attribute_key === key && attr.attribute_display_type === 'checkbox'\n    );\n  });\n};\n\nexport const isCustomAttributeList = (customAttributes, type) => {\n  return customAttributes.find(attr => {\n    return (\n      attr.attribute_key === type && attr.attribute_display_type === 'list'\n    );\n  });\n};\n\nexport const getOperatorTypes = key => {\n  const operatorMap = {\n    list: OPERATOR_TYPES_1,\n    text: OPERATOR_TYPES_3,\n    number: OPERATOR_TYPES_1,\n    link: OPERATOR_TYPES_1,\n    date: OPERATOR_TYPES_4,\n    checkbox: OPERATOR_TYPES_1,\n  };\n\n  return operatorMap[key] || OPERATOR_TYPES_1;\n};\n\nexport const generateCustomAttributeTypes = (customAttributes, type) => {\n  return customAttributes.map(attr => {\n    return {\n      key: attr.attribute_key,\n      name: attr.attribute_display_name,\n      inputType: getCustomAttributeInputType(attr.attribute_display_type),\n      filterOperators: getOperatorTypes(attr.attribute_display_type),\n      customAttributeType: type,\n    };\n  });\n};\n\nexport const generateConditionOptions = (options, key = 'id') => {\n  return options.map(i => {\n    return {\n      id: i[key],\n      name: i.title,\n    };\n  });\n};\n\n// Add the \"None\" option to the agent list\nexport const addNoneToList = agents => [\n  {\n    id: 'nil',\n    name: 'None',\n  },\n  ...(agents || []),\n];\n\nexport const getActionOptions = ({\n  agents,\n  teams,\n  labels,\n  slaPolicies,\n  type,\n}) => {\n  const actionsMap = {\n    assign_agent: addNoneToList(agents),\n    assign_team: addNoneToList(teams),\n    send_email_to_team: teams,\n    add_label: generateConditionOptions(labels, 'title'),\n    remove_label: generateConditionOptions(labels, 'title'),\n    change_priority: PRIORITY_CONDITION_VALUES,\n    add_sla: slaPolicies,\n  };\n  return actionsMap[type];\n};\n\nexport const getConditionOptions = ({\n  agents,\n  booleanFilterOptions,\n  campaigns,\n  contacts,\n  countries,\n  customAttributes,\n  inboxes,\n  languages,\n  statusFilterOptions,\n  teams,\n  type,\n}) => {\n  if (isCustomAttributeCheckbox(customAttributes, type)) {\n    return booleanFilterOptions;\n  }\n\n  if (isCustomAttributeList(customAttributes, type)) {\n    return getCustomAttributeListDropdownValues(customAttributes, type);\n  }\n\n  const conditionFilterMaps = {\n    status: statusFilterOptions,\n    assignee_id: agents,\n    contact: contacts,\n    inbox_id: inboxes,\n    team_id: teams,\n    campaigns: generateConditionOptions(campaigns),\n    browser_language: languages,\n    conversation_language: languages,\n    country_code: countries,\n    message_type: MESSAGE_CONDITION_VALUES,\n    priority: PRIORITY_CONDITION_VALUES,\n  };\n\n  return conditionFilterMaps[type];\n};\n\nexport const getFileName = (action, files = []) => {\n  const blobId = action.action_params[0];\n  if (!blobId) return '';\n  if (action.action_name === 'send_attachment') {\n    const file = files.find(item => item.blob_id === blobId);\n    if (file) return file.filename.toString();\n  }\n  return '';\n};\n\nexport const getDefaultConditions = eventName => {\n  if (eventName === 'message_created') {\n    return [\n      {\n        attribute_key: 'message_type',\n        filter_operator: 'equal_to',\n        values: '',\n        query_operator: 'and',\n        custom_attribute_type: '',\n      },\n    ];\n  }\n  if (eventName === 'conversation_opened') {\n    return [\n      {\n        attribute_key: 'browser_language',\n        filter_operator: 'equal_to',\n        values: '',\n        query_operator: 'and',\n        custom_attribute_type: '',\n      },\n    ];\n  }\n  return [\n    {\n      attribute_key: 'status',\n      filter_operator: 'equal_to',\n      values: '',\n      query_operator: 'and',\n      custom_attribute_type: '',\n    },\n  ];\n};\n\nexport const getDefaultActions = () => {\n  return [\n    {\n      action_name: 'assign_agent',\n      action_params: [],\n    },\n  ];\n};\n\nexport const filterCustomAttributes = customAttributes => {\n  return customAttributes.map(attr => {\n    return {\n      key: attr.attribute_key,\n      name: attr.attribute_display_name,\n      type: attr.attribute_display_type,\n    };\n  });\n};\n\nexport const getStandardAttributeInputType = (automationTypes, event, key) => {\n  return automationTypes[event].conditions.find(item => item.key === key)\n    .inputType;\n};\n\nexport const generateAutomationPayload = payload => {\n  const automation = JSON.parse(JSON.stringify(payload));\n  automation.conditions[automation.conditions.length - 1].query_operator = null;\n  automation.conditions = filterQueryGenerator(automation.conditions).payload;\n  automation.actions = actionQueryGenerator(automation.actions);\n  return automation;\n};\n\nexport const isCustomAttribute = (attrs, key) => {\n  return attrs.find(attr => attr.key === key);\n};\n\nexport const generateCustomAttributes = (\n  // eslint-disable-next-line default-param-last\n  conversationAttributes = [],\n  // eslint-disable-next-line default-param-last\n  contactAttributes = [],\n  conversationlabel,\n  contactlabel\n) => {\n  const customAttributes = [];\n  if (conversationAttributes.length) {\n    customAttributes.push(\n      {\n        key: `conversation_custom_attribute`,\n        name: conversationlabel,\n        disabled: true,\n      },\n      ...conversationAttributes\n    );\n  }\n  if (contactAttributes.length) {\n    customAttributes.push(\n      {\n        key: `contact_custom_attribute`,\n        name: contactlabel,\n        disabled: true,\n      },\n      ...contactAttributes\n    );\n  }\n  return customAttributes;\n};\n","export const OPERATOR_TYPES_1 = [\n  {\n    value: 'equal_to',\n    label: 'Equal to',\n  },\n  {\n    value: 'not_equal_to',\n    label: 'Not equal to',\n  },\n];\n\nexport const OPERATOR_TYPES_2 = [\n  {\n    value: 'equal_to',\n    label: 'Equal to',\n  },\n  {\n    value: 'not_equal_to',\n    label: 'Not equal to',\n  },\n  {\n    value: 'contains',\n    label: 'Contains',\n  },\n  {\n    value: 'does_not_contain',\n    label: 'Does not contain',\n  },\n];\n\nexport const OPERATOR_TYPES_3 = [\n  {\n    value: 'equal_to',\n    label: 'Equal to',\n  },\n  {\n    value: 'not_equal_to',\n    label: 'Not equal to',\n  },\n  {\n    value: 'is_present',\n    label: 'Is present',\n  },\n  {\n    value: 'is_not_present',\n    label: 'Is not present',\n  },\n];\n\nexport const OPERATOR_TYPES_4 = [\n  {\n    value: 'equal_to',\n    label: 'Equal to',\n  },\n  {\n    value: 'not_equal_to',\n    label: 'Not equal to',\n  },\n  {\n    value: 'is_present',\n    label: 'Is present',\n  },\n  {\n    value: 'is_not_present',\n    label: 'Is not present',\n  },\n  {\n    value: 'is_greater_than',\n    label: 'Is greater than',\n  },\n  {\n    value: 'is_less_than',\n    label: 'Is less than',\n  },\n];\n\nexport const OPERATOR_TYPES_5 = [\n  {\n    value: 'is_greater_than',\n    label: 'Is greater than',\n  },\n  {\n    value: 'is_less_than',\n    label: 'Is less than',\n  },\n  {\n    value: 'days_before',\n    label: 'Is x days before',\n  },\n];\n\nexport const OPERATOR_TYPES_6 = [\n  {\n    value: 'equal_to',\n    label: 'Equal to',\n  },\n  {\n    value: 'not_equal_to',\n    label: 'Not equal to',\n  },\n  {\n    value: 'contains',\n    label: 'Contains',\n  },\n  {\n    value: 'does_not_contain',\n    label: 'Does not contain',\n  },\n  {\n    value: 'starts_with',\n    label: 'Starts With',\n  },\n];\n","const allElementsString = arr => {\n  return arr.every(elem => typeof elem === 'string');\n};\n\nconst allElementsNumbers = arr => {\n  return arr.every(elem => typeof elem === 'number');\n};\n\nconst formatArray = params => {\n  if (params.length <= 0) {\n    params = [];\n  } else if (allElementsString(params) || allElementsNumbers(params)) {\n    params = [...params];\n  } else {\n    params = params.map(val => val.id);\n  }\n  return params;\n};\n\nconst generatePayloadForObject = item => {\n  if (item.action_params.id) {\n    item.action_params = [item.action_params.id];\n  } else {\n    item.action_params = [item.action_params];\n  }\n  return item.action_params;\n};\n\nconst generatePayload = data => {\n  const actions = JSON.parse(JSON.stringify(data));\n  let payload = actions.map(item => {\n    if (Array.isArray(item.action_params)) {\n      item.action_params = formatArray(item.action_params);\n    } else if (typeof item.action_params === 'object') {\n      item.action_params = generatePayloadForObject(item);\n    } else if (!item.action_params) {\n      item.action_params = [];\n    } else {\n      item.action_params = [item.action_params];\n    }\n    return item;\n  });\n  return payload;\n};\n\nexport default generatePayload;\n","export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../../../node_modules/css-loader/dist/cjs.js??ref--2-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/dist/cjs.js??ref--2-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AutomationActionTeamMessageInput.vue?vue&type=style&index=0&id=3a0353d8&prod&scoped=true&lang=css&\"","export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../../../node_modules/css-loader/dist/cjs.js??ref--2-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/dist/cjs.js??ref--2-2!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AutomationFileInput.vue?vue&type=style&index=0&id=25150911&prod&scoped=true&lang=css&\"","export * from \"-!../../../../../node_modules/mini-css-extract-plugin/dist/loader.js!../../../../../node_modules/css-loader/dist/cjs.js??ref--3-1!../../../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../node_modules/postcss-loader/dist/cjs.js??ref--3-2!../../../../../node_modules/sass-loader/dist/cjs.js??ref--3-3!../../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./AutomationActionInput.vue?vue&type=style&index=0&id=0c5a16cc&prod&lang=scss&scoped=true&\""],"sourceRoot":""}