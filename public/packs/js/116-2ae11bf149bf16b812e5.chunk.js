(window.webpackJsonp=window.webpackJsonp||[]).push([[116],{2147:function(e,t,n){"use strict";n.r(t);n(37),n(51),n(44),n(23),n(26),n(11),n(30),n(25),n(31),n(9),n(24);var a=n(34),r=n(67),o=n(271),i=n(270),s=(n(80),n(103),n(129)),l=n(69);function u(e,t,n,a,r,o,i){try{var s=e[o](i),l=s.value}catch(u){return void n(u)}s.done?t(l):Promise.resolve(l).then(a,r)}function c(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var d={props:{onClose:{type:Function,default:function(){}}},setup:function(){return{v$:Object(s.a)()}},data:function(){return{agentName:"",agentEmail:"",agentType:"agent",vertical:"bottom",horizontal:"center",roles:[{name:"administrator",label:this.$t("AGENT_MGMT.AGENT_TYPES.ADMINISTRATOR")},{name:"agent",label:this.$t("AGENT_MGMT.AGENT_TYPES.AGENT")}],show:!0}},computed:function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach((function(t){p(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},Object(a.mapGetters)({uiFlags:"agents/getUIFlags"})),validations:{agentName:{required:l.f,minLength:Object(l.d)(1)},agentEmail:{required:l.f,email:l.b},agentType:{required:l.f}},methods:{addAgent:function(){var e,t=this;return(e=regeneratorRuntime.mark((function e(){var n,a,o,i,s,l,u,c,p,d;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.$store.dispatch("agents/create",{name:t.agentName,email:t.agentEmail,role:t.agentType});case 3:Object(r.a)(t.$t("AGENT_MGMT.ADD.API.SUCCESS_MESSAGE")),t.onClose(),e.next=17;break;case 7:e.prev=7,e.t0=e.catch(0),a=e.t0.response,o=(a=void 0===a?{}:a).data,i=(o=void 0===o?{}:o).error,s=void 0===i?"":i,l=o.attributes,u=void 0===l?[]:l,c=o.message,p=void 0===c?"":c,d="",d=422!==(null===e.t0||void 0===e.t0||null===(n=e.t0.response)||void 0===n?void 0:n.status)||u.includes("base")?t.$t("AGENT_MGMT.ADD.API.ERROR_MESSAGE"):t.$t("AGENT_MGMT.ADD.API.EXIST_MESSAGE"),Object(r.a)(s||p||d);case 17:case"end":return e.stop()}}),e,null,[[0,7]])})),function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function i(e){u(o,a,r,i,s,"next",e)}function s(e){u(o,a,r,i,s,"throw",e)}i(void 0)}))})()}}},v=d,T=n(8),m=Object(T.a)(v,(function(){var e=this,t=e._self._c;return t("woot-modal",{attrs:{show:e.show,"on-close":e.onClose},on:{"update:show":function(t){e.show=t}}},[t("div",{staticClass:"flex flex-col h-auto overflow-auto"},[t("woot-modal-header",{attrs:{"header-title":e.$t("AGENT_MGMT.ADD.TITLE"),"header-content":e.$t("AGENT_MGMT.ADD.DESC")}}),e._v(" "),t("form",{staticClass:"flex flex-col items-start w-full",on:{submit:function(t){return t.preventDefault(),e.addAgent()}}},[t("div",{staticClass:"w-full"},[t("label",{class:{error:e.v$.agentName.$error}},[e._v("\n          "+e._s(e.$t("AGENT_MGMT.ADD.FORM.NAME.LABEL"))+"\n          "),t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.agentName,expression:"agentName",modifiers:{trim:!0}}],attrs:{type:"text",placeholder:e.$t("AGENT_MGMT.ADD.FORM.NAME.PLACEHOLDER")},domProps:{value:e.agentName},on:{input:[function(t){t.target.composing||(e.agentName=t.target.value.trim())},e.v$.agentName.$touch],blur:function(t){return e.$forceUpdate()}}})])]),e._v(" "),t("div",{staticClass:"w-full"},[t("label",{class:{error:e.v$.agentType.$error}},[e._v("\n          "+e._s(e.$t("AGENT_MGMT.ADD.FORM.AGENT_TYPE.LABEL"))+"\n          "),t("select",{directives:[{name:"model",rawName:"v-model",value:e.agentType,expression:"agentType"}],on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.agentType=t.target.multiple?n:n[0]}}},e._l(e.roles,(function(n){return t("option",{key:n.name,domProps:{value:n.name}},[e._v("\n              "+e._s(n.label)+"\n            ")])})),0),e._v(" "),e.v$.agentType.$error?t("span",{staticClass:"message"},[e._v("\n            "+e._s(e.$t("AGENT_MGMT.ADD.FORM.AGENT_TYPE.ERROR"))+"\n          ")]):e._e()])]),e._v(" "),t("div",{staticClass:"w-full"},[t("label",{class:{error:e.v$.agentEmail.$error}},[e._v("\n          "+e._s(e.$t("AGENT_MGMT.ADD.FORM.EMAIL.LABEL"))+"\n          "),t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.agentEmail,expression:"agentEmail",modifiers:{trim:!0}}],attrs:{type:"text",placeholder:e.$t("AGENT_MGMT.ADD.FORM.EMAIL.PLACEHOLDER")},domProps:{value:e.agentEmail},on:{input:[function(t){t.target.composing||(e.agentEmail=t.target.value.trim())},e.v$.agentEmail.$touch],blur:function(t){return e.$forceUpdate()}}})])]),e._v(" "),t("div",{staticClass:"flex flex-row justify-end w-full gap-2 px-0 py-2"},[t("div",{staticClass:"w-full"},[t("woot-submit-button",{attrs:{disabled:e.v$.agentEmail.$invalid||e.v$.agentName.$invalid||e.uiFlags.isCreating,"button-text":e.$t("AGENT_MGMT.ADD.FORM.SUBMIT"),loading:e.uiFlags.isCreating}}),e._v(" "),t("button",{staticClass:"button clear",on:{click:function(t){return t.preventDefault(),e.onClose.apply(null,arguments)}}},[e._v("\n            "+e._s(e.$t("AGENT_MGMT.ADD.CANCEL_BUTTON_TEXT"))+"\n          ")])],1)])])],1)])}),[],!1,null,null,null),g=m.exports,E=(n(57),n(89),n(750)),f=n(314),A=n(169);function _(e,t,n,a,r,o,i){try{var s=e[o](i),l=s.value}catch(u){return void n(u)}s.done?t(l):Promise.resolve(l).then(a,r)}function h(e){return function(){var t=this,n=arguments;return new Promise((function(a,r){var o=e.apply(t,n);function i(e){_(o,a,r,i,s,"next",e)}function s(e){_(o,a,r,i,s,"throw",e)}i(void 0)}))}}function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function M(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){w(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function w(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var G=n(149).b.AVAILABILITY_STATUS_KEYS,N={components:{WootSubmitButton:E.a,Modal:f.a},props:{id:{type:Number,required:!0},name:{type:String,required:!0},email:{type:String,default:""},type:{type:String,default:""},availability:{type:String,default:""},onClose:{type:Function,required:!0}},setup:function(){return{v$:Object(s.a)()}},data:function(){return{roles:[{name:"administrator",label:this.$t("AGENT_MGMT.AGENT_TYPES.ADMINISTRATOR")},{name:"agent",label:this.$t("AGENT_MGMT.AGENT_TYPES.AGENT")}],agentName:this.name,agentAvailability:this.availability,agentType:this.type,agentCredentials:{email:this.email},show:!0}},validations:{agentName:{required:l.f,minLength:Object(l.d)(1)},agentType:{required:l.f},agentAvailability:{required:l.f}},computed:M(M({pageTitle:function(){return"".concat(this.$t("AGENT_MGMT.EDIT.TITLE")," - ").concat(this.name)}},Object(a.mapGetters)({uiFlags:"agents/getUIFlags"})),{},{availabilityStatuses:function(){var e=this;return this.$t("PROFILE_SETTINGS.FORM.AVAILABILITY.STATUSES_LIST").map((function(t,n){return{label:t,value:G[n],disabled:e.currentUserAvailability===G[n]}}))}}),methods:{editAgent:function(){var e=this;return h(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.$store.dispatch("agents/update",{id:e.id,name:e.agentName,role:e.agentType,availability:e.agentAvailability});case 3:Object(r.a)(e.$t("AGENT_MGMT.EDIT.API.SUCCESS_MESSAGE")),e.onClose(),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),Object(r.a)(e.$t("AGENT_MGMT.EDIT.API.ERROR_MESSAGE"));case 10:case"end":return t.stop()}}),t,null,[[0,7]])})))()},resetPassword:function(){var e=this;return h(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,A.a.resetPassword(e.agentCredentials);case 3:Object(r.a)(e.$t("AGENT_MGMT.EDIT.PASSWORD_RESET.ADMIN_SUCCESS_MESSAGE")),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),Object(r.a)(e.$t("AGENT_MGMT.EDIT.PASSWORD_RESET.ERROR_MESSAGE"));case 9:case"end":return t.stop()}}),t,null,[[0,6]])})))()}}},O=Object(T.a)(N,(function(){var e=this,t=e._self._c;return t("modal",{attrs:{show:e.show,"on-close":e.onClose},on:{"update:show":function(t){e.show=t}}},[t("div",{staticClass:"flex flex-col h-auto overflow-auto"},[t("woot-modal-header",{attrs:{"header-title":e.pageTitle}}),e._v(" "),t("form",{staticClass:"w-full",on:{submit:function(t){return t.preventDefault(),e.editAgent()}}},[t("div",{staticClass:"w-full"},[t("label",{class:{error:e.v$.agentName.$error}},[e._v("\n          "+e._s(e.$t("AGENT_MGMT.EDIT.FORM.NAME.LABEL"))+"\n          "),t("input",{directives:[{name:"model",rawName:"v-model.trim",value:e.agentName,expression:"agentName",modifiers:{trim:!0}}],attrs:{type:"text",placeholder:e.$t("AGENT_MGMT.EDIT.FORM.NAME.PLACEHOLDER")},domProps:{value:e.agentName},on:{input:[function(t){t.target.composing||(e.agentName=t.target.value.trim())},e.v$.agentName.$touch],blur:function(t){return e.$forceUpdate()}}})])]),e._v(" "),t("div",{staticClass:"w-full"},[t("label",{class:{error:e.v$.agentType.$error}},[e._v("\n          "+e._s(e.$t("AGENT_MGMT.EDIT.FORM.AGENT_TYPE.LABEL"))+"\n          "),t("select",{directives:[{name:"model",rawName:"v-model",value:e.agentType,expression:"agentType"}],on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.agentType=t.target.multiple?n:n[0]}}},e._l(e.roles,(function(n){return t("option",{key:n.name,domProps:{value:n.name}},[e._v("\n              "+e._s(n.label)+"\n            ")])})),0),e._v(" "),e.v$.agentType.$error?t("span",{staticClass:"message"},[e._v("\n            "+e._s(e.$t("AGENT_MGMT.EDIT.FORM.AGENT_TYPE.ERROR"))+"\n          ")]):e._e()])]),e._v(" "),t("div",{staticClass:"w-full"},[t("label",{class:{error:e.v$.agentAvailability.$error}},[e._v("\n          "+e._s(e.$t("PROFILE_SETTINGS.FORM.AVAILABILITY.LABEL"))+"\n          "),t("select",{directives:[{name:"model",rawName:"v-model",value:e.agentAvailability,expression:"agentAvailability"}],on:{change:function(t){var n=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.agentAvailability=t.target.multiple?n:n[0]}}},e._l(e.availabilityStatuses,(function(n){return t("option",{key:n.value,domProps:{value:n.value}},[e._v("\n              "+e._s(n.label)+"\n            ")])})),0),e._v(" "),e.v$.agentAvailability.$error?t("span",{staticClass:"message"},[e._v("\n            "+e._s(e.$t("AGENT_MGMT.EDIT.FORM.AGENT_AVAILABILITY.ERROR"))+"\n          ")]):e._e()])]),e._v(" "),t("div",{staticClass:"flex flex-row justify-end w-full gap-2 px-0 py-2"},[t("div",{staticClass:"w-[50%]"},[t("woot-submit-button",{attrs:{disabled:e.v$.agentType.$invalid||e.v$.agentName.$invalid||e.uiFlags.isUpdating,"button-text":e.$t("AGENT_MGMT.EDIT.FORM.SUBMIT"),loading:e.uiFlags.isUpdating}}),e._v(" "),t("button",{staticClass:"button clear",on:{click:function(t){return t.preventDefault(),e.onClose.apply(null,arguments)}}},[e._v("\n            "+e._s(e.$t("AGENT_MGMT.EDIT.CANCEL_BUTTON_TEXT"))+"\n          ")])],1),e._v(" "),t("div",{staticClass:"w-[50%] text-right"},[t("woot-button",{attrs:{icon:"lock-closed",variant:"clear"},on:{click:function(t){return t.preventDefault(),e.resetPassword.apply(null,arguments)}}},[e._v("\n            "+e._s(e.$t("AGENT_MGMT.EDIT.PASSWORD_RESET.ADMIN_RESET_BUTTON"))+"\n          ")])],1)])])],1)])}),[],!1,null,null,null);function y(e,t,n,a,r,o,i){try{var s=e[o](i),l=s.value}catch(u){return void n(u)}s.done?t(l):Promise.resolve(l).then(a,r)}function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function D(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach((function(t){$(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function $(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var S={components:{AddAgent:g,EditAgent:O.exports,Thumbnail:i.a},mixins:[o.a],data:function(){return{loading:{},showAddPopup:!1,showDeletePopup:!1,showEditPopup:!1,agentAPI:{message:""},currentAgent:{}}},computed:D(D({},Object(a.mapGetters)({agentList:"agents/getAgents",uiFlags:"agents/getUIFlags",currentUserId:"getCurrentUserID",globalConfig:"globalConfig/get"})),{},{deleteConfirmText:function(){return"".concat(this.$t("AGENT_MGMT.DELETE.CONFIRM.YES")," ").concat(this.currentAgent.name)},deleteRejectText:function(){return"".concat(this.$t("AGENT_MGMT.DELETE.CONFIRM.NO")," ").concat(this.currentAgent.name)},deleteMessage:function(){return" ".concat(this.currentAgent.name,"?")}}),mounted:function(){this.$store.dispatch("agents/get")},methods:{showEditAction:function(e){return this.currentUserId!==e.id},showDeleteAction:function(e){return this.currentUserId!==e.id&&(!e.confirmed||("administrator"!==e.role||1!==this.verifiedAdministrators().length))},verifiedAdministrators:function(){return this.agentList.filter((function(e){return"administrator"===e.role&&e.confirmed}))},openAddPopup:function(){this.showAddPopup=!0},hideAddPopup:function(){this.showAddPopup=!1},openEditPopup:function(e){this.showEditPopup=!0,this.currentAgent=e},hideEditPopup:function(){this.showEditPopup=!1},openDeletePopup:function(e){this.showDeletePopup=!0,this.currentAgent=e},closeDeletePopup:function(){this.showDeletePopup=!1},confirmDeletion:function(){this.loading[this.currentAgent.id]=!0,this.closeDeletePopup(),this.deleteAgent(this.currentAgent.id)},deleteAgent:function(e){var t,n=this;return(t=regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,n.$store.dispatch("agents/delete",e);case 3:n.showAlertMessage(n.$t("AGENT_MGMT.DELETE.API.SUCCESS_MESSAGE")),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),n.showAlertMessage(n.$t("AGENT_MGMT.DELETE.API.ERROR_MESSAGE"));case 9:case"end":return t.stop()}}),t,null,[[0,6]])})),function(){var e=this,n=arguments;return new Promise((function(a,r){var o=t.apply(e,n);function i(e){y(o,a,r,i,s,"next",e)}function s(e){y(o,a,r,i,s,"throw",e)}i(void 0)}))})()},showAlertMessage:function(e){this.loading[this.currentAgent.id]=!1,this.currentAgent={},this.agentAPI.message=e,Object(r.a)(e)}}},I=S,R=Object(T.a)(I,(function(){var e=this,t=e._self._c;return t("div",{staticClass:"flex-1 p-4 overflow-auto"},[t("woot-button",{attrs:{"color-scheme":"success","class-names":"button--fixed-top",icon:"add-circle"},on:{click:function(t){return e.openAddPopup()}}},[e._v("\n    "+e._s(e.$t("AGENT_MGMT.HEADER_BTN_TXT"))+"\n  ")]),e._v(" "),t("div",{staticClass:"flex flex-row gap-4"},[t("div",{staticClass:"w-full lg:w-3/5"},[e.uiFlags.isFetching?t("woot-loading-state",{attrs:{message:e.$t("AGENT_MGMT.LOADING")}}):t("div",[e.agentList.length?t("table",{staticClass:"woot-table"},[t("tbody",e._l(e.agentList,(function(n,a){return t("tr",{key:n.email},[t("td",[t("thumbnail",{attrs:{src:n.thumbnail,username:n.name,size:"40px",status:n.availability_status}})],1),e._v(" "),t("td",[t("span",{staticClass:"agent-name"},[e._v("\n                  "+e._s(n.name)+"\n                ")]),e._v(" "),t("span",[e._v(e._s(n.email))])]),e._v(" "),t("td",[t("span",{staticClass:"agent-name"},[e._v("\n                  "+e._s(e.$t(`AGENT_MGMT.AGENT_TYPES.${n.role.toUpperCase()}`))+"\n                ")]),e._v(" "),n.confirmed?t("span",[e._v("\n                  "+e._s(e.$t("AGENT_MGMT.LIST.VERIFIED"))+"\n                ")]):e._e(),e._v(" "),n.confirmed?e._e():t("span",[e._v("\n                  "+e._s(e.$t("AGENT_MGMT.LIST.VERIFICATION_PENDING"))+"\n                ")])]),e._v(" "),t("td",[t("div",{staticClass:"button-wrapper"},[e.showEditAction(n)?t("woot-button",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:e.$t("AGENT_MGMT.EDIT.BUTTON_TEXT"),expression:"$t('AGENT_MGMT.EDIT.BUTTON_TEXT')",modifiers:{top:!0}}],attrs:{variant:"smooth",size:"tiny","color-scheme":"secondary",icon:"edit","class-names":"grey-btn"},on:{click:function(t){return e.openEditPopup(n)}}}):e._e(),e._v(" "),e.showDeleteAction(n)?t("woot-button",{directives:[{name:"tooltip",rawName:"v-tooltip.top",value:e.$t("AGENT_MGMT.DELETE.BUTTON_TEXT"),expression:"$t('AGENT_MGMT.DELETE.BUTTON_TEXT')",modifiers:{top:!0}}],attrs:{variant:"smooth","color-scheme":"alert",size:"tiny",icon:"dismiss-circle","class-names":"grey-btn","is-loading":e.loading[n.id]},on:{click:function(t){return e.openDeletePopup(n,a)}}}):e._e()],1)])])})),0)]):t("p",[e._v("\n          "+e._s(e.$t("AGENT_MGMT.LIST.404"))+"\n        ")])])],1),e._v(" "),t("div",{staticClass:"hidden w-1/3 lg:block"},[t("span",{directives:[{name:"dompurify-html",rawName:"v-dompurify-html",value:e.useInstallationName(e.$t("AGENT_MGMT.SIDEBAR_TXT"),e.globalConfig.installationName),expression:"\n          useInstallationName(\n            $t('AGENT_MGMT.SIDEBAR_TXT'),\n            globalConfig.installationName\n          )\n        "}]})])]),e._v(" "),t("woot-modal",{attrs:{show:e.showAddPopup,"on-close":e.hideAddPopup},on:{"update:show":function(t){e.showAddPopup=t}}},[t("add-agent",{attrs:{"on-close":e.hideAddPopup}})],1),e._v(" "),t("woot-modal",{attrs:{show:e.showEditPopup,"on-close":e.hideEditPopup},on:{"update:show":function(t){e.showEditPopup=t}}},[e.showEditPopup?t("edit-agent",{attrs:{id:e.currentAgent.id,name:e.currentAgent.name,type:e.currentAgent.role,email:e.currentAgent.email,availability:e.currentAgent.availability_status,"on-close":e.hideEditPopup}}):e._e()],1),e._v(" "),t("woot-delete-modal",{attrs:{show:e.showDeletePopup,"on-close":e.closeDeletePopup,"on-confirm":e.confirmDeletion,title:e.$t("AGENT_MGMT.DELETE.CONFIRM.TITLE"),message:e.$t("AGENT_MGMT.DELETE.CONFIRM.MESSAGE"),"message-value":e.deleteMessage,"confirm-text":e.deleteConfirmText,"reject-text":e.deleteRejectText},on:{"update:show":function(t){e.showDeletePopup=t}}})],1)}),[],!1,null,null,null);t.default=R.exports}}]);
//# sourceMappingURL=116-2ae11bf149bf16b812e5.chunk.js.map